---
title: "[THUPC 2023 决赛] 百合"
layout: "post"
diff: 提高+/省选-
pid: P9377
tag: ['2023', 'O2优化', '最短路', 'THUPC']
---
# [THUPC 2023 决赛] 百合
## 题目背景

葡萄藤上开不出百合花。
## 题目描述

你落在一个巨大的葡萄架上，上面一共有 $2^k$ 朵百合花和 $m$ 条葡萄藤。其中，百合花编号为 $0$ 到 $2^k-1$ 的整数，第 $i$ 条葡萄藤连接了编号为 $x_i, y_i$ 的百合花。

你可以花费 $c_i$ 的时间通过第 $i$ 条葡萄藤，也就是从 $x_i$ 走到 $y_i$，或者反过来；还可以花费 $a_k$ 的时间从 $x$ 闪现到 $y$，其中 $x, y$ 是任意两朵百合花，$k$ 是它们在二进制表示下不同的比特数。例如，$3$ 的二进制表示是 $011$，$5$ 的二进制表示是 $101$，它们有两位不同，因此从 $3$ 闪现到 $5$ 花费的时间是 $a_2$。

假设你恰好落在编号为 $s$ 的百合花上，求从 $s$ 出发到每一朵百合花所需要的最短时间。
## 输入格式

第一行包含三个正整数 $k,m,s$，其含义如题目描述。

第二行包含 $k$ 个非负整数 $a_i$，表示通道花费的时间。

第 $3$ 至第 $(m+2)$ 行每行三个非负整数 $x_i,y_i,c_i$。
## 输出格式

输出一行 $2^k$ 个数 $D_i$（$0 \leq i \leq 2^k-1$），空格隔开，其中 $D_i$ 表示从 $s$ 到 $i$ 的最短时间。
## 样例

### 样例输入 #1
```
3 6 2
17 14 11 
0 2 3
4 2 9
2 2 1
2 2 6
7 0 5
4 2 9

```
### 样例输出 #1
```
3 14 0 17 9 11 17 8

```
## 提示

**【数据范围】**

对于所有测试数据，$1 \le k \leq 17$，$1 \le m \leq 2 \times 10^5$，$0 \leq s,x_i,y_i \leq 2^k - 1$，$0 \le a_i, c_i \leq 2^{30} - 1$。

**【题目来源】**


来自 2023 清华大学学生程序设计竞赛暨高校邀请赛（THUPC2023）决赛。

题解等资源可在 [https://github.com/THUSAAC/THUPC2023](https://github.com/THUSAAC/THUPC2023) 查看。
