---
diff: NOI/NOI+/CTSC
pid: P10776
name: BZOJ3914 Jabby's shadows
tag: ['Link-Cut Tree,LCT']
---
# BZOJ3914 Jabby's shadows
## 题目描述

给出一棵 $n$ 个点的无根树，树有边权，每个点有两种颜色，最初所有点均为黑色。黑色为 1，白色为 2。每条边有正的权值。

需要维护 $m$ 次操作：
- `1 u`：询问 $u$ 所在树上同色连通块的直径。若为 0，则输出 QwQ。
- `2 u v c`：将 $u \sim v$ 的链覆盖为颜色 $c$。
## 输入格式

第一行一个正整数 $n$，表示树的结点个数。

第二行 $n-1$ 个正整数 $f_i$，表示结点 $2\sim n$ 的父结点。

第三行 $n-1$ 个正整数 $e_i$，表示 $2\sim n$ 号结点到父结点的边的边权。

第四行一个正整数 $m$，表示操作数。接下来 $m$ 行依次表示操作。
## 输出格式

对于每个 $1$ 操作输出一行作为答案。
## 样例

### 样例输入 #1
```
5
1 2 3 3
2 2 4 3
5
1 3
1 1
2 4 4 2
2 3 1 1
1 2
```
### 样例输出 #1
```
8
8
7
```
## 提示

数据保证，$1\leq n,m\leq 100000$，$1\leq e_i\leq 10000$。
