---
title: "三色"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P9685
tag: ['计算几何', '洛谷原创', 'O2优化', '洛谷月赛']
---
# 三色
## 题目背景

我的心脏还在跳动着啊。
## 题目描述

给定 $n$ 个三元组 $(a_i,b_i,c_i)$。$q$ 次询问，每次给定一个集合 $S$，查询是否存在实数三元组 $(p,q,r)$ 满足：对于所有满足 $pa_i+qb_i+r>0$ 的 $i$，其 $c_i$ 构成的集合恰好为 $S$。
## 输入格式

第一行输入一个整数 $T$，代表数据组数。

对于每组数据，第一行输入三个数 $n,q,k$，其中 $k=|S|$。

接下来 $n$ 行，每行输入三个整数 $a_i,b_i,c_i$。

接下来 $q$ 行，第 $i$ 行输入 $k$ 个整数 $s_{i,1},s_{i,2},\dots,s_{i,k}$，代表第 $i$ 组询问中 $S$ 的元素。保证元素不重复。
## 输出格式

对于每组数据，输出一行一个长为 $q$ 的字符串 $R$，对于第 $i$ 组询问，若答案为存在，则 $R_i$ 为 $\tt 1$，否则为 $\tt 0$。
## 样例

### 样例输入 #1
```
3
5 2 1
3 0 1
-2 2 2
1 -3 3
-2 -1 4
0 0 5
2
5
5 4 2
3 0 1
-2 2 2
1 -3 3
-2 -1 4
0 0 5
2 3
2 4
5 1
3 5
5 6 3
3 0 1
-2 2 2
1 -3 3
-2 -1 4
0 0 5
3 5 4
2 5 3
4 2 1
2 4 3
3 1 2
3 1 4
```
### 样例输出 #1
```
10
0110
100101
```
## 提示

### 数据规模与约定

对于所有数据，$1\le n,\sum n\le 10^5$，$1\le q,\sum q \le 3\times 10^5$，$1\le k\le 3$，$1\le c_i,s_{i,j}\le n$，$|a_i|,|b_i|\le 10^9$。

对于任意 $i\neq j$，保证 $(a_i,b_i)\neq (a_j,b_j)$，且不存在 $(p,q)$ 和三个不同的下标 $i,j,k$ 满足 $pa_i+qb_i=pa_j+qb_j=pa_k+qb_k$。

### 子任务

| # | 特殊性质 | 分值 |
| :----------: | :----------: | :----------: |
| 0 | 样例 | 0 |
| 1 | $n\le 3$ | 2 |
| 2 | $k=1$ | 11 |
| 3 | $\sum n^2\le 10^6$ | 23 |
| 4 | $k=2$ | 29 |
| 5 | $k=3$ | 35 |
