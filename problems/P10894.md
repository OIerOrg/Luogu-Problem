---
title: "虚树"
layout: "post"
diff: 提高+/省选-
pid: P10894
tag: ['O2优化']
usemathjax: true
---

# 虚树
## 题目背景

首先，做这道题不需要用到任何虚树有关知识。

——尽管这是主题库里第一个名字含“虚树”的题（
## 题目描述

jq 姐姐有一棵以结点 $1$ 为根的树。定义一棵树的点集 $S$ 的非空子集 $s$ 是好的，当且仅当它满足 $\forall i,j \in s, \text{LCA}(i,j) \in s$。[什么是 $\text{LCA}$？](https://oi-wiki.org/graph/lca/)

为了让树的形态更加可爱，jq 姐姐打算修剪掉某个以节点 $i$ 为根的子树（也就是在原树里将节点 $i$ 及其子树内节点及其相连的边均删除）。

她有若干个修剪方案但从未实施，你需要求出每种方案实施后这棵树的好的非空子集数量。由于答案可能会很大，请输出其对 $998244353$ 取模的结果。
## 输入格式

第一行读入一个整数 $n$ ($n \leq 5 \times 10^5$)，表示树的节点数。

第 $2$ 到 $n$ 行，每行读入两个整数 $u_i,v_i$，表示一条从 $u_i$ 连向 $v_i$ 的边。

第 $n+1$ 行读入一个整数 $m$ ($m \leq 5 \times 10^5$)，表示修剪方案数。

接下来一行每行读入 $m$ 个整数 $q_i$，表示将以 $q_i$ 为根的子树修剪掉。
## 输出格式

共 $m$ 行，第 $i$ 行一个整数 $k$ 表示删除以 $q_i$ 为根的子树后原树的好的非空子集数量。
## 样例

### 样例输入 #1
```
5
1 2
2 3
2 4
1 5
2
2 5
```
### 样例输出 #1
```
3
13
```
### 样例输入 #2
```
10
1 2
2 3
2 4
1 5
5 6
5 7
7 8
7 10
1 9
3
5 2 8
```
### 样例输出 #2
```
21
66
201
```
## 提示

样例 1 解释：删去以 $2$ 为根的子树后，原树点集的 $3$ 个非空子集均满足性质，删去以 $5$ 为根的子树后，原树点集的 $15$ 个非空子集中有 $\{3,4\}$、$\{1,3,4\}$ 不满足性质。

对于前 $10\%$  的数据，$n,m \leq 20$。

对于前 $30\%$ 的数据，$n,m \leq 3000$。

对于 $100\%$ 的数据，$1 \leq n,m \leq 5 \times 10^5$，$q \in [1,n]$。
