---
title: "[入门赛 #14] 魔法少女扶苏 (Hard Version)"
layout: "post"
diff: 普及/提高-
pid: P9457
tag: ['2023', 'O2优化', '语言月赛']
---
# [入门赛 #14] 魔法少女扶苏 (Hard Version)
## 题目描述

给定一个 $n$ 行 $m$ 列的数字矩阵，第 $i$ 行第 $j$ 列的数称为 $a_{i,j}$。

扶苏可以释放任意多次魔法，每次施放魔法，矩阵里的**每个**数字都会被减去 $1$。

现在扶苏想知道，她至少需要释放几次魔法，才能让矩阵中存在至少 $k$ 个位置 $(x, y)$，满足 $a_{x, y}$ 大于或等于它所在行和列的元素之和。

形式化地，你需要计算最小的魔法释放次数使得施放魔法后存在至少 $k$ 个位置 $(x, y)$，满足 $a_{x, y} \geq \sum \limits _{i = 1}^n a_{i,y} + \sum \limits _{i = 1}^m a_{x,i}$。
## 输入格式

第一行是三个整数，表示矩阵的行数 $n$，列数 $m$ 和要求符合条件的位置个数 $k$。

接下来 $n$ 行，每行 $m$ 个整数，第 $i$ 行的第 $j$ 个整数表示初始的 $a_{i,j}$。
## 输出格式

输出一行一个整数表示答案。
## 样例

### 样例输入 #1
```
2 3 1
1 2 3
4 5 6

```
### 样例输出 #1
```
3
```
## 提示

### 样例 1 解释

释放 $3$ 次魔法后，矩阵变为

$$\begin{matrix}-2 & -1 & 0\\1& 2&3\\\end{matrix}$$

于是 $a_{1,1} = -2 > (-1) + (-3) = \sum\limits_{i =1}^n a_{i,1} + \sum\limits_{i = 1}^m a_{1, i}$。

### 数据规模与约定

- 对 $100\%$ 的数据，保证 $1 \leq n, m \leq 3 \times 10^3$，$1 \leq k \leq n \times m$，$0 \leq a_i \leq 10^{11}$。

### 提示

**请使用合理的读入方式，避免超时。**
