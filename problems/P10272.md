---
title: "在四方城外"
layout: "post"
diff: 省选/NOI-
pid: P10272
tag: []
---
# 在四方城外
## 题目背景

> 柳花、青山与月光。
>
> 诗中的酒香与诗外的酒香。
>
> 城中的天空与城外的天空。
>
> 一字一句，一笔一划，所知晓的，尚懵懂的。
>
> 	看呀看，学呀学，世界正如浊酒，滋味饮酌方知。
## 题目描述

定义字符串 $S$ 的**扩展**操作为：

- 求出 $S$ 的最长 $\text{border}$ $T$。

- $S'\leftarrow S+T$。

**注意，本题的 $\text{border}$ 指真 $\text{border}$（即字符串本身不计入 $\text{border}$）**。

设**扩展**操作的权值为**扩展**后字符串的长度 $|S'|$，请求出字符串 $S$ 第 $L$  次**扩展**到第 $R$ 次**扩展**的权值之和。

由于结果可能很大，请输出答案对 $998244353$ 取模的结果。
## 输入格式

第一行一个字符串 $S$。

第二行两个整数 $L,R$。
## 输出格式

输出为一个数，即答案对 $998244353$ 取模的结果。
## 样例

### 样例输入 #1
```
ababcab
1 3
```
### 样例输出 #1
```
39
```
### 样例输入 #2
```
aa
3 5
```
### 样例输出 #2
```
59
```
## 提示

### 样例一解释

第 $1$ 次扩展操作：`ababcab[ab]`，权值为 $9$。

第 $2$ 次扩展操作：`ababcabab[abab]`，权值为 $13$。

第 $3$ 次扩展操作：`ababcabababab[abab]`，权值为 $17$。

权值之和为 $9+13+17=39$。

### 数据范围与约束

对于 $30\%$ 的数据，$1 \le |S| \le 100,1 \le L,R \le 10$。

对于 $60\%$ 的数据，$1 \le L,R \le 10^6$。

对于另外 $10\%$ 的数据，$\text{border}_{S}=|S|-1$。

对于 $100\%$ 的数据，$1 \le |S| \le 10^6,1 \le L \le R \le 10^9$，输入均为整数和小写字母。
