---
title: "【模板】模意义下的乘法逆元 2"
layout: "post"
diff: 普及+/提高
pid: P5431
tag: ['数学', 'O2优化']
---
# 【模板】模意义下的乘法逆元 2
## 题目描述

给定 $n$ 个正整数 $a_i$ ，求它们在模 $p$ 意义下的乘法逆元。

由于输出太多不好，所以将会给定常数 $k$，你要输出的答案为：  
$$\sum\limits_{i=1}^n\frac{k^i}{a_i}$$

答案对 $p$ 取模。
## 输入格式

第一行三个正整数 $n,p,k$，意义如题目描述。  
第二行 $n$ 个正整数 $a_i$，是你要求逆元的数。
## 输出格式

输出一行一个整数，表示答案。
## 样例

### 样例输入 #1
```
6 233 42
1 4 2 8 5 7
```
### 样例输出 #1
```
91
```
## 提示

对于 $30\%$ 的数据，$1\le n \le 10^5$。

对于 $100\%$ 数据，$1\le n \le 5\times 10^6$，$2\le k < p \le 10^9$，$1\le a_i < p$，保证 $p$ 为质数。

提示：本题时间限制较为严格，请注意使用较快的 IO 方式。
