---
title: "BZOJ4317 Atm 的树"
layout: "post"
diff: 省选/NOI-
pid: P10604
tag: ['平衡树', 'O2优化', '动态树分治']
---
# BZOJ4317 Atm 的树
## 题目背景

题目来自原 BZOJ，我们承认题面及原数据的版权均属于原 BZOJ 或将题目授权给 BZOJ 使用的出题人。如果您是版权所有者且认为我们侵犯了您的权益，可联系我们。

---

Atm 有一段时间在虐 qtree 的题目，于是，他满脑子都是 tree，tree，tree……
## 题目描述

于是，一天晚上他梦到自己被关在了一个有根树中，每条路径都有边权，一个神秘的声音告诉他，每个点到其他的点有一个距离，他需要对于每个点回答：从这个点出发的第 $k$ 小距离是多少；

如果 atm 不能回答出来，那么明天 4019 的闹钟将不会响，4019 全寝可能就迟到了，所以 atm 希望你帮帮他。
## 输入格式

第一行两个整数 $n,k$，表述询问的树的结点个数，以及题目中的 $k$。

接下来 $n-1$ 行，每行三个正整数 $u,v,w$，表示从结点 $u$ 到 $v$ 有一条边权为 $w$ 的边。
## 输出格式

共 $n$ 行，第 $i$ 行表示从结点 $i$ 出发的第 $k$ 小距离为多少。
## 样例

### 样例输入 #1
```
5 2
1 5 2
1 2 4
2 3 6
2 4 5
```
### 样例输出 #1
```
4
5
10
9
6
```
## 提示

对于所有数据，$1\leq n\leq 15000$，$1\leq k\leq 5000$，$1\leq w\leq 10$。树的根为结点 $1$。
