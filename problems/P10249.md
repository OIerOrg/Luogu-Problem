---
title: "【模板】多项式复合函数（加强版）"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P10249
tag: ['多项式', 'O2优化', '快速傅里叶变换 FFT', '快速数论变换 NTT']
usemathjax: true
---

# 【模板】多项式复合函数（加强版）
## 题目背景

本题相较于 [P5373](https://www.luogu.com.cn/problem/P5373) 扩大了数据范围。
## 题目描述

给定一个 $n$ 次多项式 $F(x)$，和一个 $m$ 次多项式 $G(x)$，你需要求一个 $n$ 次多项式 $H(x)$ ，满足条件：  
$$H(x) \equiv F(G(x))\space (\text{mod }x^{n+1})$$   
换种说法，你要求的多项式应满足：  
$$H(x) \equiv \sum_{i=0}^n [x^i]F(x)\times G(x)^i \space (\text{mod }x^{n+1})$$
将结果的各项系数对 $998244353$ 取模。
## 输入格式

第一行两个正整数 $n,m$，分别表示 $F(x)$ 和 $G(x)$ 的次数。

第二行 $n+1$ 个非负整数 $f_i$，表示 $F(x)$ 的 $i$ 次项系数。

第三行 $m+1$ 个非负整数 $g_i$，表示 $G(x)$ 的 $i$ 次项系数。   
## 输出格式

输出一行 $n+1$ 个非负整数，从低到高表示 $H(x)$ 的系数。
## 样例

### 样例输入 #1
```
4 3
1 2 3 4 5
1 2 3 4
```
### 样例输出 #1
```
15 80 300 892 2069
```
## 提示

**数据范围：**  

- $1\le m \le n \le 200000$    
- $f_i,g_i \in [0,998244353)\cap \mathbb Z$

| 测试点编号 | $m,n\le$ |
| :----------: | :----------: |
| $1,2$ | $30000$ |
| $3,4$ | $50000$ |
| $5,6$ | $100000$ |
| $7,8$ | $150000$ |
| $9,10$ | $200000$ |

