---
title: "赌博游戏【数据有误】"
layout: "post"
diff: 提高+/省选-
pid: P1921
tag: ['数学']
usemathjax: true
---

# 赌博游戏【数据有误】
## 题目背景

赌场是暴利的。大赌场通过游戏规则控制游戏的公平来赚钱。虽然规则看似很公平，但实际上是稍微有点不公平的，而大赌场由于客流量大，资金流量大，这点稍微的不公平就被放大到能让赌场得到很可观的收入。同时，这些个不公平有时并不是规则的不公平，而是道具不公平。比如说灌铅的骰子，它和正常骰子不一样，它投出 $Q$ 种点数的概率并不一样。有时，为了不让顾客察觉，他们每一次游戏结束后都有可能更换骰子。
## 题目描述

作弊的赌场有 $N$ 个骰子，在这个赌场可能发生了 $M$ 次游戏，每次游戏包括一个骰子投出的点数，我们并不知道这个骰子的编号，但知道第 $i$ 次游戏投出的点数 $O(i)$。

第 $i$ 个骰子投出点数 $j$ 的概率是 $A(i,j)$，用完第 $i$ 个骰子，下一次用第 $j$ 个骰子的概率为 $B(i,j)$。特别地，对于第一次游戏，用第 $i$ 个骰子的概率为 $\pi(i)$。

好奇的小 $v$ 来问你，在这个赌场发生这 $M$ 次游戏的概率。
## 输入格式

第一行两个正整数 $N,M,Q$。

第二行 $N$ 个浮点数，表示 $\pi(i)$。

第三行至 $2+N$ 行有 $N\times Q$ 个浮点数，第 $i+2$ 行 $j$ 列表示 $A(i,j)$。

第 $N+3$ 至 $2\times N+2$ 行有 $N\times N$ 个浮点数，第 $N+2+i$ 行 $j$ 列表示 $B(i,j)$。

第 $2\times N+3$ 行有 $M$ 个正整数，表示 $M$ 次游戏的结果 $O_i$，也就是每次游戏投出的点数。
## 输出格式

表示所求概率，保留四位位小数。

## 样例

### 样例输入 #1
```
3 10 3
1 0 0
0.03 0.03 0.94
0.02 0.02 0.96
0.99 0.005 0.005
0.01 0.99 0
0.05 0.05 0.90
0.98 0.002 0.008 
2 2 0 2 2 0 2 2 0 2

```
### 样例输出 #1
```
0.4483
```
## 提示

### 数据范围及约定

- 对于 $30\%$ 的数据：$M \le 100$，$1 \le N$，$Q \le 10$；
- 对于 $100\%$ 的数据：$1 \le M \le 1000$，$1 \le N$，$Q \le 50$。

对于矩阵 $A,B$，向量 $\pi$ 都具备概率转移的特征条件。
