---
title: "[AGM 2023 资格赛] 回文"
layout: "post"
diff: 省选/NOI-
pid: P9282
tag: ['2023', 'O2优化', 'AGM']
usemathjax: true
---

# [AGM 2023 资格赛] 回文
## 题目描述

定义一个关于一个字符串 $x$ 的函数 $f(x)$ 如下：

- 如果 $x$ 长度为 $1$，$f(x)=1$。
- 如果 $x$ 不是回文串，$f(x)=0$。
- 如果 $x$ 是回文串，那么假设 $y$ 是 $x$ 的前 $\frac{|x|+1}{2}$ 个字符组成的字符串 $f(x)=f(y)+1$。

给你一个字符串 $s$ 与一个数 $k$，求它每个非空子串中 $f$ 等于 $1\sim k$ 的分别有多少个。
## 输入格式

第一行两个数 $N(1\leq N\leq 10^5)$，$k(1\leq k\leq 30)$。

接下来一行一个长度为 $N$ 的字符串 $s$。保证由小写字母组成。
## 输出格式

对于 $1\sim k$ 的每个数输出答案。
## 样例

### 样例输入 #1
```
4 3
bbab

```
### 样例输出 #1
```
5 1 0 

```
### 样例输入 #2
```
3 3
bbb

```
### 样例输出 #2
```
3 2 1 

```
