---
title: "[APC001] E - Linear Map"
layout: "post"
diff: 普及+/提高
pid: P11140
tag: ['动态规划,dp', 'O2优化']
---
# [APC001] E - Linear Map
## 题目背景

**请注意本题的特殊时间限制，并酌情使用较快的输入输出方式**。

在广阔的 florr 世界中，有一个不为人知的角落，它的建立是为了方便快速测试新 mob，而现在它被废弃了，但没有消失。

冒险者 MF 找到了这里，并发现其名字为：Linear map。
## 题目描述

Linear map 可看作一个字符串，每个字符都是一个 $0\sim 9$ 的数字。

MF 认为，如果一个字符串存在两段长度均 $>1$ 的不同区间的和相同，那么该字符串是无趣的。

比如，$3421$ 就是无趣的字符串，因为 $3+4=4+2+1$，而 $5023$ 也是无趣的字符串，因为 $5+0=2+3$。相反，$13$ 和 $285$ 都不是无趣的字符串。

MF 打算将 Linear map 划分为若干非空连续且不重复的子段，这些子段包含了整个字符串的所有字符，且满足每个子段都不是无趣的字符串。

MF 是一个有趣的人，于是它想算出划分的方案数，并对 $998244353$ 取模。
## 输入格式

一行一个字符串 $s$。
## 输出格式

一行一个整数表示答案对 $998244353$ 取模后的结果。
## 样例

### 样例输入 #1
```
453
```
### 样例输出 #1
```
4
```
### 样例输入 #2
```
3333
```
### 样例输出 #2
```
5
```
### 样例输入 #3
```
9475739582850286
```
### 样例输出 #3
```
9360
```
## 提示

### 样例解释

- 样例 $\tt\#1$
	
所有划分均合法：$\{453\},\{45,3\},\{4,53\},\{4,5,3\}$。

- 样例 $\tt\#2$
	
合法方案为：$\{33,33\},\{33,3,3\},\{3,33,3\},\{3,3,33\},\{3,3,3,3\}$。

### 数据范围

对于 $100\%$ 的数据，满足 $1\le |s|\le 1.5\times 10^7$，且 $s$ 中仅包含数字。
