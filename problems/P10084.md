---
title: "[GDKOI2024 提高组] 计算"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P10084
tag: ['2024', '广东', 'O2优化']
---
# [GDKOI2024 提高组] 计算
## 题目描述

定义 $F(x, a, b) = \gcd(x^a - 1, x^b - 1) + 1, x > 0$。

特别的，如果 $a = 0$ 或 $b = 0$，$F(x, a, b) = 0$。

现在给出五个非负整数 $m, a, b, c, d$。

令 $L = F(m, a, b) + 1$，$R = F(m, c, d)$。

问集合 $\{L, L + 1, L + 2, \dots, R - 2, R - 1, R\}$ 有多少个子集和是 $m$ 的倍数。

由于答案可能很大，你只需要输出方案数对 $998244353$ 取模后的结果就可以了。
## 输入格式

输入第一行为一个整数 $T$，表示数据组数。

接下来一行 $T$ 行，每行五个非负整数 $m, a, b, c, d$。
## 输出格式

对于每组数据，输出答案。
## 样例

### 样例输入 #1
```
3
5 0 0 2 1
4 1 2 2 4
8 3 2 4 6
```
### 样例输出 #1
```
8
1024
527847872
```
## 提示

**【样例解释】**

经过计算可知 $L=1$，$R=5$，集合是 $1,2,3,4,5$，满足条件的子集和有以下 $8$ 个：

$\{\}$，$\{5\}$，$\{2, 3\}$，$\{1, 4\}$，$\{1, 2, 3, 4\}$，$\{2, 3, 5\}$，$\{1, 4, 5\}$，$\{1, 2, 3, 4, 5\}$。

**【数据范围】**

| 测试点编号 | $m$ | $L$ | $R$ | $a$ | $b$ | $c$ | $d$ | $T$ | 特殊性质 |
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
| $1$ | $m=2$ | $L=1$ | $R=2$ | $a=0$ | $b=0$ | $c\leq 10$ | $d\leq 10$ | $T\leq 5$ | 无 |
| $2$ | $m\leq 10$ | $L=1$ | $R=m$ | $a=0$ | $b=0$ | $c\leq 10$ | $d\leq 10$ | $T\leq 5$ | 无 |
| $3$ | $m\leq 5$ | $L\leq 10^3$ | $R\leq 10^3$ | $a\leq 10$ | $b\leq 10$ | $c\leq 10$ | $d\leq 10$ | $T\leq 5$ | $1$ |
| $4\sim 6$ | $m\leq 20$ | $L\leq 2\times 10^3$ | $R\leq 2\times 10^3$ | $a\leq 10$ | $b\leq 10$ | $c\leq 10$ | $d\leq 10$ | $T\leq 5$ | 无 |
| $7$ | $m\leq 20$ | $L\leq 10^5$ | $R\leq 10^5$ | $a\leq 10^2$ | $b\leq 10^2$ | $c\leq 10^2$ | $d\leq 10^2$ | $T\leq 5$ | $2$ |
| $8,9$ | $m\leq 80$ | $L\leq 10^9$ | $R\leq 10^9$ | $a\leq 10^2$ | $b\leq 10^2$ | $c\leq 10^2$ | $d\leq 10^2$ | $T\leq 5$ | 无 |
| $10\sim 13$ | $m\leq 2\times 10^3$ | $L\leq 10^{18}$ | $R\leq 10^{18}$ | $a\leq 10^3$ | $b\leq 10^3$ | $c\leq 10^3$ | $d\leq 10^3$ | $T\leq 5$ | 无 |
| $14\sim 17$ | $m\leq 10^5$ | $L\leq 10^{18}$ | $R\leq 10^{18}$ | $a\leq 10^3$ | $b\leq 10^3$ | $c\leq 10^3$ | $d\leq 10^3$ | $T\leq 5$ | 无 |
| $18\sim 20$ | $m\leq 10^7$ | $L\leq 10^{18}$ | $R\leq 10^{18}$ | $a\leq 10^3$ | $b\leq 10^3$ | $c\leq 10^3$ | $d\leq 10^3$ | $T\leq 10^4$ | 无 |

- 特殊性质 1：$R - L + 1 \leq 20$；
- 特殊性质 2：$R - L + 1 \leq 2000$；

对于全部数据，保证 $L < R$，$m > 0$。
