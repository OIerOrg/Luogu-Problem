---
title: "[GESP202312 八级] 大量的工作沟通"
layout: "post"
diff: 普及/提高-
pid: P10113
tag: ['2023', '最近公共祖先,LCA', 'GESP']
---
# [GESP202312 八级] 大量的工作沟通
## 题目描述

某公司有 $N$ 名员工，编号从 $0$ 至 $N-1$。其中，除了 $0$ 号员工是老板，其余每名员工都有一个直接领导。我们假设编号为 $i$ 的员工的直接领导是 $f_i$。

该公司有严格的管理制度，每位员工只能受到本人或直接领导或间接领导的管理。具体来说，规定员工 $x$ 可以管理员工 $y$，当且仅当 $x=y$，或 $x=f_y$，或 $x$ 可以管理 $f_y$。特别地，$0$ 号员工老板只能自我管理，无法由其他任何员工管理。

现在，有一些同事要开展合作，他们希望找到一位同事来主持这场合作，这位同事必须能够管理参与合作的所有同事。如果有多名满足这一条件的员工，他们希望找到编号最大的员工。你能帮帮他们吗？
## 输入格式

第一行一个整数 $N$ ，表示员工的数量。

第二行 $N-1$ 个用空格隔开的正整数，依次为 $f_1, f_2, \dots f_{N-1}$。

第三行一个整数 $Q$ ，表示共有 $Q$ 场合作需要安排。

接下来 $Q$ 行，每行描述一场合作：开头是一个整数 $m$（$2 \leq m \leq N$），表示参与本次合作的员工数量；接着是 $m$ 个整数，依次表示参与本次合作的员工编号（保证编号合法且不重复）。

保证公司结构合法，即不存在任意一名员工，其本人是自己的直接或间接领导。
## 输出格式

输出 $Q$ 行，每行一个整数，依次为每场合作的主持人选。

## 样例

### 样例输入 #1
```
5
0 0 2 2
3
2 3 4
3 2 3 4
2 1 4
```
### 样例输出 #1
```
2
2
0
```
### 样例输入 #2
```
7
0 1 0 2 1 2
5
2 4 6
2 4 5
3 4 5 6
4 2 4 5 6
2 3 4
```
### 样例输出 #2
```
2
1
1
1
0
```
## 提示

**样例解释 1**

对于第一场合作，员工 $3,4$ 有共同领导 $2$ ，可以主持合作。

对于第二场合作，员工 $2$ 本人即可以管理所有参与者。

对于第三场合作，只有 $0$ 号老板才能管理所有员工。

**数据范围**

对于 $25\%$ 的测试点，保证 $N \leq 50$。 

对于 $50\%$ 的测试点，保证 $N \leq 300$。

对于所有测试点，保证 $3 \leq N \leq 10^5$，$Q \leq 100$，$m \leq 10^4$。


------------
2024/2/8 添加一组 hack 数据。
