---
title: "[HEOI2012] 朋友圈"
layout: "post"
diff: 省选/NOI-
pid: P2423
tag: ['2012', '各省省选', '河北']
usemathjax: true
---

# [HEOI2012] 朋友圈
## 题目背景

原 双塔 请做P1651
## 题目描述

在很久很久以前，曾经有两个国家和睦相处，无忧无虑的生活着．

一年一度的评比大会开始了，作为和平的两国，一个朋友圈数量最多的永远都是最值得他人的尊敬，所以现在就是需要你求朋友圈的最大数目．两个国家看成是 AB 两国，现在是两个国家的描述：

- A 国：每个人都有一个友善值，当两个 A 国人的友善值 $a,b$，如果 $(a\mathbin{\mathrm{xor}} b) \bmod 2=1$，那么这两个人都是朋友，否则不是；
- B 国：每个人都有一个友善值，当两个 B 国人的友善值 $a,b$，如果 $(a\mathbin{\mathrm{xor}} b) \bmod 2=0$ 或者 $(a\mathbin{\mathrm{or}} b)$ 化成二进制有奇数个 $1$，那么两个人是朋友，否则不是朋友．

A、B 两国之间的人也有可能是朋友，数据中将会给出 A、B 之间「朋友」的情况．

对于朋友的定义，关系是是双向的．

在 AB 两国，朋友圈的定义：一个朋友圈集合 $S$，满足 $S \subset A \cup B$，对于所有的 $i,j \in S$，$i$ 和 $j$ 是朋友．

## 输入格式

**本题包含多组数据．**

- 第一行一个整数 $T$，表示输入数据总数．
- 对于每组数据：
  - 第 $1$ 行 $3$ 个整数 $A,B,M$，分别表示 A 国人数，B 国人数，AB 两国之间是朋友的对数．
  - 第 $2$ 行 $A$ 个整数 $a_i$，表示 A 国第 $i$ 个人的友善值．
  - 第 $3$ 行 $B$ 个整数 $b_i$，表示 B 国第 $i$ 个人的友善值．
  - 第 $4$ 到第 $3+M$ 行，每行两个整数 $x,y$ 表示 A 国的第 $x$ 个人和 B 国第 $y$ 个人是朋友．
## 输出格式

- 输出 $T$ 行，每行输出一个整数，表示最大朋友圈的数目．
## 样例

### 样例输入 #1
```
1
2 4 7
1 2
2 6 5 4
1 1
1 2
1 3
2 1
2 2
2 3
2 4
```
### 样例输出 #1
```
5

```
## 提示

### 样例解释

最大朋友圈包含 A 国第 $1,2$ 人和 B 国第 $1,2,3$ 人．

### 数据范围

对于 $100\%$ 的数据，$1 \le T \le 6$，$1 \le a_i, b_i < 2^{31}$．

本题共有两类数据，保证所有测试点均满足其中至少一类的限制：

- 第一类：$1 \le A \le 200, 1 \le B \le 200$．
- 第二类：$1 \le A \le 10, 1 \le B \le 3000$．
