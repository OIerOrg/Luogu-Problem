---
title: "「Daily OI Round 3」Tower"
layout: "post"
diff: 普及+/提高
pid: P10127
tag: ['洛谷原创', 'O2优化', '差分']
usemathjax: true
---

# 「Daily OI Round 3」Tower
## 题目背景

定义 $(x_1,y_1),(x_2,y_2)$ 的 `A 距离` 为 $\max\{|x_1-x_2|,|y_1-y_2|\}+1$，下文中的距离都指的是 `A 距离`。

比如说，$(1,1)$ 和 $(3,8)$ 的 `A 距离` 为 $\max\{|1-3|,|1-8|\}+1=8$。

比如说，$(46,1)$ 和 $(35,9)$ 的 `A 距离` 为 $\max\{|46-35|,|1-9|\}+1=12$。
## 题目描述

A 国的国土可以看成是 $n\times m$ 的矩阵，第 $x$ 行第 $y$ 列坐标为 $(x,y)$。

国土可以是山地，用 `#` 表示，可以是平地，用 `.` 表示。

A 国在每一个平地建了一个能量塔，能量塔搜集能量的范围是正方形的。如果 $e$ 满足到该能量塔 `A 距离` **不超过** $e$ 的地方是 A 国的国土，并且该地方是平地，则称 $e$ 是该能量塔的基准能量。

一个能量塔的综合能量 $E$ 为该能量塔基准能量 $e$ 的最大值。

特殊地，如果这个地方没有能量塔，该处综合能量 $E=0$，否则，该处的综合能量就是能量塔的综合能量。

记第 $i$ 行第 $j$ 列的综合能量为 $E_{i,j}$。

记一个国家的能量总和 $\xi=\sum\limits^n_{i=1}\sum\limits_{j=1}^mE_{i,j}^2$。

你需要求一个国家的能量总和 $\xi$。

当然，由于特殊的原因（比如宇宙射线的影响），某一个地方的平地可能会突然变成山地，当地的能量塔也会被摧毁，而且影响到附近能量塔的综合能量 $E$。

作为 A 国的参谋，国王想让你预备方案，看看每一个非山地的点变成山地之后，该国家的能量总和是多少。
## 输入格式

第一行两个整数 $n,m$。

下面是一个 $n\times m$ 的矩阵，第 $i$ 行第 $j$ 列为 `#` 或 `.`，描述 A 国的地形。
## 输出格式

输出共 $n+1$ 行。

第一行一个整数 $\xi$，表示 A 国开始的能量总和。

下面是一个 $n\times m$ 的矩阵，第 $i+1$ 行第 $j$ 个整数表示 $(i,j)$ 变成山地之后该国家的能量总和 $\xi_{i,j}$，特殊地，如果 $(i,j)$ 原来是山地，输出 $-1$。
## 样例

### 样例输入 #1
```
3 4
....
...#
....
```
### 样例输出 #1
```
14
10 10 10 13
10 10 10 -1
10 10 10 13
```
### 样例输入 #2
```
5 6
...#..
#.....
......
......
...#..
```
### 样例输出 #2
```
39
38 38 38 -1 38 38
-1 35 32 29 32 35
35 32 29 29 32 35
35 32 29 29 32 35
35 35 35 -1 38 38
```
### 样例输入 #3
```
7 7
....#..
.#.....
.......
.......
.#...##
..#####
.......
```
### 样例输出 #3
```
51
50 50 50 50 -1 50 50
50 -1 47 44 41 44 47
50 50 44 41 38 44 47
50 50 44 41 38 44 47
50 -1 47 47 47 -1 -1
50 50 -1 -1 -1 -1 -1
50 50 50 50 50 50 50
```
## 提示

#### 【样例解释 #1】

下面举 $3$ 个例子：

开始，这个国家的 $E_{i,j}$ 如下：

```
1 1 1 1 
1 2 1 0
1 1 1 1
```

$(1,1)$ 变成山地后，$E_{i,j}$ 如下：

```
0 1 1 1
1 1 1 0
1 1 1 1
```



$(3,4)$ 变成山地后，$E_{i,j}$ 如下：

```
1 1 1 1
1 2 1 0
1 1 1 0
```

#### 【数据范围】

对于全部数据保证：$1\le n,m\le600$。
