---
title: "[Ynoi2001] 雪に咲く花"
layout: "post"
diff: NOI/NOI+/CTSC
pid: P9335
tag: ['2001', 'O2优化', 'Ynoi']
---
# [Ynoi2001] 雪に咲く花
## 题目背景

&emsp;何もいらない   
&emsp;不再奢求什么   
&emsp;あなたがいればいい   
&emsp;只要有相伴   
&emsp;そっと橫顏 息を殺す   
&emsp;悄悄地侧着脸 屏住呼吸   
&emsp;まばたきすれば   
&emsp;似乎一眨眼   
&emsp;消えてしまいそうで   
&emsp;就会突然消失一般   
&emsp;凝視(みつ)めさせて 好きだよ   
&emsp;凝视着我喜欢的你   

&emsp;あぁ 木々が震え 降り出した雪   
&emsp;啊啊 树影摇曳 落雪纷纷   
&emsp;足跡 ふたつ 白く   
&emsp;唯留两行白色的足迹   
&emsp;時よ 積もれ   
&emsp;时光 点点堆积   
&emsp;時よ 積もれ   
&emsp;时光 点点堆积   
&emsp;髪に 胸に ふたりだけの夢に   
&emsp;在发间 在心中 只属于你我的梦中   
&emsp;咲けない花の種は   
&emsp;无法开出花朵的种子   
&emsp;雪に抱かれ 寄り添うの   
&emsp;在雪的怀抱中 相依相偎   
&emsp;靜かに忘れられたい   
&emsp;只想静静地被遗忘   
![](https://cdn.luogu.com.cn/upload/image_hosting/g60pi7fc.png)
## 题目描述

给序列 $a_1,\dots,a_n$，$b_1,\dots,b_n$，$c_1,\dots,c_n$，

定义区间 $[l,r]$ 的价值为 $a_l,\dots,a_r$ 按位与，$b_l,\dots,b_r$ 按位或，$c_l,\dots,c_r$ 的最大公因数，这三者的乘积；

$m$ 次查询，每次查询给出区间 $[l,r]$，查询满足 $l\le l'\le r'\le r$ 的 $[l',r']$ 的价值之和。
## 输入格式

第一行两个整数 $n,m$；

第二行 $n$ 个整数 $a_1,\dots,a_n$；

第三行 $n$ 个整数 $b_1,\dots,b_n$；

第四行 $n$ 个整数 $c_1,\dots,c_n$；

接下来 $m$ 行，每行两个整数 $l,r$ 表示一次查询。

## 输出格式

共 $m$ 行，每行一个整数，表示对应的答案，答案对 $2^{32}$ 取模后输出。

## 样例

### 样例输入 #1
```
5 3
3 3 1 1 1
2 1 3 2 2
4 5 3 4 4
1 2
2 5
4 5

```
### 样例输出 #1
```
48
63
24

```
## 提示

Idea：nzhtl1477，Solution：ccz181078，Code：ccz181078，Data：ccz181078

对于 $100\%$ 的数据，满足

$1\le n\le 10^6$

$1\le m\le 5\times 10^6$

$1\le a_i,b_i,c_i\le n$

$1\le l\le r\le n$

建议使用高效的输入输出方式。

